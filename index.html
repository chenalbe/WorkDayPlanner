<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Work Day Planner</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <script src="https://momentjs.com/downloads/moment-with-locales.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
    <div class="row">
        <div class="col-6 col-md-4"></div>
        <div class="col-6 col-md-4"><h1><center>Work Day Planner</center></h1></div>
        <div class="col-6 col-md-4"></div>
    </div>
    <div class='time-frame'>
        <div id='date-part'></div>
        <div id='time-part'></div>
    </div>
    <hr>
    <table class="table table-hover">
        <thead class="thead-dark">
          <tr>
            <th scope="col" style="width: 10%">Hour</th>
            <th scope="col" style="width: 80%">Tasks</th>
            <th scope="col"style="width: 10%"></th>
          </tr>
        </thead>
        <tbody>
            <tr id='0' value = 9>
                <th scope="row" style="width: 10%">9:00 AM</th>
                <td style="width: 80%" id = 'task0'><textarea class="border-0" id="exampleFormControlTextarea0" rows="1"></textarea></td>
                <td style="width: 10%"><input class="btn btn-primary" type="submit" value="Save" id ="0"></td>
            </tr>
            <tr id= '1' value = 10> 
                <th scope="row" style="width: 10%">10:00 AM</th>
                <td style="width: 80%" id = 'task1'><textarea class="border-0" id="exampleFormControlTextarea1" rows="1"></textarea></td>
                <td style="width: 10%"><input class="btn btn-primary" type="submit" value="Save" id ="1"></td>
            </tr>
            <tr id= '2' value = 11>
                <th scope="row" style="width: 10%">11:00 AM</th>
                <td style="width: 80%" id = 'task2'><textarea class="border-0" id="exampleFormControlTextarea2" rows="1"></textarea></td>
                <td style="width: 10%"><input class="btn btn-primary" type="submit" value="Save" id ="2"></td>
            </tr>
            <tr id= '3' value = 12>
                <th scope="row" style="width: 10%">12:00 PM</th>
                <td style="width: 80%"id = 'task3'><textarea class="border-0" id="exampleFormControlTextarea3" rows="1"></textarea></td>
                <td style="width: 10%"><input class="btn btn-primary" type="submit" value="Save" id ="3"></td>
            </tr>
            <tr id = '4' value = 13>
                <th scope="row" style="width: 10%">1:00 PM</th>
                <td style="width: 80%" id = 'task4'><textarea class="border-0" id="exampleFormControlTextarea4" rows="1"></textarea></td>
                <td style="width: 10%"><input class="btn btn-primary" type="submit" value="Save" id ="4"></td>
            </tr>
            <tr id = '5' value = 14>
                <th scope="row" style="width: 10%">2:00 PM</th>
                <td style="width: 80%"id = 'task5'><textarea class="border-0" id="exampleFormControlTextarea5" rows="1"></textarea></td>
                <td style="width: 10%"><input class="btn btn-primary" type="submit" value="Save" id ="5"></td>
            </tr>
            <tr id = '6' value = 15>
                <th scope="row" style="width: 10%">3:00 PM</th>
                <td style="width: 80%" id = 'task6'><textarea class="border-0" id="exampleFormControlTextarea6" rows="1"></textarea></td>
                <td style="width: 10%"><input class="btn btn-primary" type="submit" value="Save" id ="6"></td>
            </tr>
            <tr id = '7' value = 16>
                <th scope="row" style="width: 10%">4:00 PM</th>
                <td style="width: 80%" id = 'task7'><textarea class="border-0" id="exampleFormControlTextarea7" rows="1"></textarea></td>
                <td style="width: 10%"><input class="btn btn-primary" type="submit" value="Save" id ="7"></td>
            </tr>
            <tr id = '8' value = 17>
                <th scope="row" style="width: 10%">5:00 PM</th>
                <td style="width: 80%" id = 'task8'><textarea class="border-0" id="exampleFormControlTextarea8" rows="1"></textarea></td>
                <td style="width: 10%"><input class="btn btn-primary" type="submit" value="Save" id ="8"></td>
            </tr>
        </tbody>
    <script type="text/javascript">
        $(document).ready(function() {
            var interval = setInterval(function() {
            var momentNow = moment();
            $('#date-part').html(momentNow.format('YYYY MMMM DD') + ' '
                            + momentNow.format('dddd')
                             .substring(0,3).toUpperCase());
            $('#time-part').html(momentNow.format('A hh:mm:ss'));
            }, 100);
        });
    var d = new Date();
    var currentHour = d.getHours();
    var taskList= [ , , , , , , , , ];
    function colorCodingD() {
       for (var i=0; i<9; i++){
           var tableHour = parseInt($('#'+i).attr("value"));
           if (tableHour < currentHour) {
            $('#'+i).css('background-color', 'grey');
            $("#exampleFormControlTextarea"+i).css('background-color', 'grey');
           }
           if (tableHour === currentHour) {
            $('#'+i).css('background-color', 'red');
            $("#exampleFormControlTextarea"+i).css('background-color', 'red');
           }
           if (tableHour > currentHour) {
            $('#'+i).css('background-color', 'green');
            $("#exampleFormControlTextarea"+i).css('background-color', 'green');
           }
       }
    };
    function taskModify() {
        $(".btn").click(function() {
            event.preventDefault();
            var row = $(this).attr("id");
            var task = $.trim($("#exampleFormControlTextarea"+row).val());
            console.log(task);
            var taskString = JSON.stringify(task);
            console.log(taskString);
            localStorage.setItem("taskInput"+row, taskString);
            $('#task'+row).text(task);
        });
    };
    function renderTask() {
        for (i=0; i<9; i++) {
            var storedTask = JSON.parse(localStorage.getItem("taskInput"+i));
            console.log(storedTask);
            if (storedTask === null) {
                return;
            }
            else {
            $('#exampleFormControlTextarea'+i).before("<div>"+storedTask+"</div>");
            }
        }
    };
    colorCodingD();
    taskModify();
    renderTask();
    </script>
</body>
</html>